<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FATTO CRIMINAL - Jogos de Mist√©rio e Investiga√ß√£o</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #0d0d0d;
            color: #e0e0e0;
            min-height: 100vh;
        }

        /* ==================== HEADER ==================== */
        header {
            background: rgba(0, 0, 0, 0.95);
            padding: 20px 5%;
            position: fixed;
            width: 100%;
            top: 0;
            z-index: 1000;
            border-bottom: 1px solid rgba(220, 53, 69, 0.3);
        }

        .header-content {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            font-size: 28px;
            font-weight: bold;
            color: #dc3545;
            letter-spacing: 3px;
            text-transform: uppercase;
            cursor: pointer;
        }

        nav {
            display: flex;
            gap: 40px;
            align-items: center;
        }

        nav a {
            color: #e0e0e0;
            text-decoration: none;
            font-weight: 500;
            transition: color 0.3s;
            cursor: pointer;
        }

        nav a:hover {
            color: #dc3545;
        }

        .btn-primary {
            background: #dc3545;
            color: white;
            padding: 12px 30px;
            border-radius: 25px;
            border: none;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-primary:hover {
            background: #c82333;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(220, 53, 69, 0.4);
        }

        .btn-secondary {
            background: transparent;
            color: #dc3545;
            padding: 12px 30px;
            border-radius: 25px;
            border: 2px solid #dc3545;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-secondary:hover {
            background: #dc3545;
            color: white;
        }

        /* ==================== SECTIONS ==================== */
        .section {
            display: none;
            padding-top: 100px;
            min-height: 100vh;
        }

        .section.active {
            display: block;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 5%;
        }

        /* ==================== HERO ==================== */
        .hero {
            text-align: center;
            padding: 80px 0;
            background: linear-gradient(135deg, rgba(220, 53, 69, 0.1) 0%, rgba(0, 0, 0, 0) 100%);
        }

        .hero h1 {
            font-size: 52px;
            margin-bottom: 20px;
            color: #dc3545;
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        .hero p {
            font-size: 20px;
            color: #999;
            margin-bottom: 40px;
        }

        /* ==================== CARDS ==================== */
        .cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
            margin: 60px 0;
        }

        .card {
            background: #1a1a1a;
            border-radius: 15px;
            padding: 30px;
            border: 2px solid rgba(220, 53, 69, 0.3);
            transition: all 0.3s;
            cursor: pointer;
        }

        .card:hover {
            transform: translateY(-10px);
            border-color: #dc3545;
            box-shadow: 0 10px 30px rgba(220, 53, 69, 0.3);
        }

        .card-icon {
            font-size: 48px;
            margin-bottom: 20px;
        }

        .card h3 {
            color: #dc3545;
            font-size: 24px;
            margin-bottom: 15px;
        }

        .card p {
            color: #999;
            line-height: 1.6;
        }

        /* ==================== COMO FUNCIONA ==================== */
        #como-funciona {
            padding: 80px 0;
            background: rgba(220, 53, 69, 0.05);
        }

        .steps {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 40px;
            margin-top: 40px;
        }

        .step {
            text-align: center;
            padding: 30px;
            background: #1a1a1a;
            border-radius: 15px;
            border: 2px solid rgba(220, 53, 69, 0.2);
        }

        .step-number {
            width: 60px;
            height: 60px;
            background: #dc3545;
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 28px;
            font-weight: bold;
            margin: 0 auto 20px;
        }

        .step h3 {
            color: #dc3545;
            margin-bottom: 15px;
            font-size: 20px;
        }

        .step p {
            color: #999;
            line-height: 1.6;
        }

        /* ==================== CASOS ==================== */
        .caso-item {
            background: #1a1a1a;
            border-radius: 15px;
            overflow: hidden;
            border: 2px solid rgba(220, 53, 69, 0.3);
            transition: all 0.3s;
            height: 100%;
            display: flex;
            flex-direction: column;
        }

        .caso-item:hover {
            transform: translateY(-5px);
            border-color: #dc3545;
            box-shadow: 0 10px 30px rgba(220, 53, 69, 0.3);
        }

        .caso-image {
            height: 200px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 72px;
        }

        .caso-content {
            padding: 25px;
            flex: 1;
            display: flex;
            flex-direction: column;
        }

        .caso-title {
            color: #dc3545;
            font-size: 22px;
            margin-bottom: 10px;
            font-weight: bold;
        }

        .caso-desc {
            color: #999;
            margin-bottom: 20px;
            flex: 1;
        }

        .caso-info {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-bottom: 20px;
            padding: 15px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
        }

        .caso-info-item {
            display: flex;
            align-items: center;
            gap: 8px;
            color: #999;
            font-size: 14px;
        }

        /* ==================== RANKING ==================== */
        .podio {
            display: flex;
            justify-content: center;
            align-items: flex-end;
            gap: 20px;
            margin: 60px 0;
            flex-wrap: wrap;
        }

        .podio-item {
            text-align: center;
            background: #1a1a1a;
            border-radius: 15px;
            padding: 30px 20px;
            border: 2px solid rgba(220, 53, 69, 0.3);
            min-width: 200px;
        }

        .podio-item.primeiro {
            border-color: #ffc107;
            order: 2;
        }

        .podio-item.segundo {
            border-color: #c0c0c0;
            order: 1;
        }

        .podio-item.terceiro {
            border-color: #cd7f32;
            order: 3;
        }

        .podio-medal {
            font-size: 64px;
            margin-bottom: 15px;
        }

        .ranking-list {
            background: #1a1a1a;
            border-radius: 15px;
            padding: 30px;
            border: 2px solid rgba(220, 53, 69, 0.3);
        }

        .ranking-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            margin-bottom: 10px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            transition: all 0.3s;
        }

        .ranking-item:hover {
            background: rgba(220, 53, 69, 0.1);
        }

        .ranking-item.destaque {
            background: rgba(220, 53, 69, 0.2);
            border: 2px solid #dc3545;
        }

        /* ==================== √ÅREA DO DETETIVE ==================== */
        .area-header {
            text-align: center;
            margin-bottom: 40px;
        }

        .area-header h1 {
            color: #dc3545;
            font-size: 42px;
            margin-bottom: 10px;
        }

        .area-menu {
            display: flex;
            gap: 15px;
            margin-bottom: 30px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .area-menu-btn {
            background: rgba(220, 53, 69, 0.1);
            color: #e0e0e0;
            padding: 15px 30px;
            border-radius: 10px;
            border: 2px solid rgba(220, 53, 69, 0.3);
            cursor: pointer;
            transition: all 0.3s;
            font-size: 16px;
            font-weight: bold;
        }

        .area-menu-btn:hover,
        .area-menu-btn.active {
            background: #dc3545;
            border-color: #dc3545;
        }

        .area-content {
            display: none;
        }

        .area-content.active {
            display: block;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 25px;
            margin-bottom: 40px;
        }

        .stat-card {
            background: #1a1a1a;
            padding: 30px;
            border-radius: 15px;
            border: 2px solid rgba(220, 53, 69, 0.3);
            text-align: center;
            transition: all 0.3s;
        }

        .stat-card:hover {
            transform: translateY(-5px);
            border-color: #dc3545;
        }

        .stat-icon {
            font-size: 48px;
            margin-bottom: 15px;
        }

        .stat-value {
            font-size: 36px;
            font-weight: bold;
            color: #dc3545;
            margin-bottom: 10px;
        }

        .stat-label {
            color: #999;
            font-size: 14px;
        }

        /* ==================== PERFIL ==================== */
        .perfil-card {
            background: #1a1a1a;
            border-radius: 15px;
            padding: 40px;
            border: 2px solid rgba(220, 53, 69, 0.3);
            max-width: 600px;
            margin: 0 auto;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            color: #999;
            margin-bottom: 8px;
            font-size: 14px;
        }

        .form-group input {
            width: 100%;
            padding: 12px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(220, 53, 69, 0.3);
            border-radius: 8px;
            color: #e0e0e0;
            font-size: 15px;
        }

        .form-group input:focus {
            outline: none;
            border-color: #dc3545;
        }

        /* ==================== AJUDA ==================== */
        .faq-item {
            background: #1a1a1a;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
            border: 2px solid rgba(220, 53, 69, 0.3);
            cursor: pointer;
            transition: all 0.3s;
        }

        .faq-item:hover {
            border-color: #dc3545;
        }

        .faq-question {
            font-size: 18px;
            font-weight: bold;
            color: #dc3545;
            margin-bottom: 10px;
        }

        .faq-answer {
            color: #999;
            line-height: 1.6;
        }

        /* ==================== MODAL ==================== */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            z-index: 2000;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: #1a1a1a;
            border-radius: 20px;
            padding: 25px;
            max-width: 450px;
            width: 100%;
            border: 2px solid #dc3545;
            position: relative;
            max-height: 85vh;
            overflow-y: auto;
        }

        .modal-content::-webkit-scrollbar {
            width: 8px;
        }

        .modal-content::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
        }

        .modal-content::-webkit-scrollbar-thumb {
            background: #dc3545;
            border-radius: 10px;
        }

        .modal-close {
            position: absolute;
            top: 15px;
            right: 15px;
            background: none;
            border: none;
            color: #999;
            font-size: 24px;
            cursor: pointer;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .modal-close:hover {
            color: #dc3545;
        }

        .modal-title {
            font-size: 22px;
            color: #dc3545;
            margin-bottom: 5px;
            text-align: center;
        }

        .modal-subtitle {
            text-align: center;
            color: #999;
            margin-bottom: 20px;
            font-size: 13px;
        }

        .tabs {
            display: flex;
            margin-bottom: 20px;
            border-bottom: 2px solid rgba(220, 53, 69, 0.3);
        }

        .tab {
            flex: 1;
            padding: 10px;
            text-align: center;
            cursor: pointer;
            background: none;
            border: none;
            color: #999;
            font-size: 14px;
            font-weight: bold;
            transition: all 0.3s;
        }

        .tab.active {
            color: #dc3545;
            border-bottom: 3px solid #dc3545;
        }

        .message {
            padding: 12px;
            border-radius: 8px;
            margin-bottom: 15px;
            text-align: center;
            display: none;
            font-size: 14px;
        }

        .message.success {
            background: rgba(40, 167, 69, 0.2);
            color: #28a745;
            border: 1px solid #28a745;
        }

        .message.error {
            background: rgba(220, 53, 69, 0.2);
            color: #dc3545;
            border: 1px solid #dc3545;
        }

        /* ==================== DELEGADO VIRTUAL ==================== */
        .delegado-btn {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: #dc3545;
            color: white;
            padding: 15px 25px;
            border-radius: 50px;
            border: none;
            font-weight: bold;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(220, 53, 69, 0.4);
            z-index: 1500;
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 15px;
            transition: all 0.3s;
        }

        .delegado-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(220, 53, 69, 0.6);
        }

        /* ==================== FOOTER ==================== */
        footer {
            background: #000;
            padding: 60px 5% 30px;
            margin-top: 80px;
            border-top: 1px solid rgba(220, 53, 69, 0.3);
        }

        .footer-content {
            max-width: 1400px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 40px;
            margin-bottom: 40px;
        }

        .footer-section h3 {
            color: #dc3545;
            margin-bottom: 20px;
            font-size: 18px;
        }

        .footer-section p,
        .footer-section a {
            color: #999;
            margin-bottom: 10px;
            display: block;
            text-decoration: none;
            transition: color 0.3s;
        }

        .footer-section a:hover {
            color: #dc3545;
        }

        .footer-bottom {
            text-align: center;
            padding-top: 30px;
            border-top: 1px solid rgba(220, 53, 69, 0.2);
            color: #666;
        }

        /* ==================== RESPONSIVE ==================== */
        @media (max-width: 768px) {
            .hero h1 {
                font-size: 36px;
            }

            .hero p {
                font-size: 16px;
            }

            nav {
                gap: 20px;
            }

            .logo {
                font-size: 22px;
            }

            .cards {
                grid-template-columns: 1fr;
            }

            .podio {
                flex-direction: column;
                align-items: center;
            }

            .podio-item {
                width: 100%;
                max-width: 300px;
            }

            .modal-content {
                padding: 20px;
                max-height: 90vh;
            }

            .modal-title {
                font-size: 20px;
            }

            .form-group {
                margin-bottom: 15px;
            }

            .form-group input {
                padding: 10px;
            }

            .btn-primary {
                padding: 10px 20px;
            }

            .area-menu {
                flex-direction: column;
            }

            .area-menu-btn {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <!-- ==================== HEADER ==================== -->
    <header>
        <div class="header-content">
            <div class="logo" onclick="showSection('home')">FATTO CRIMINAL</div>
            <nav id="mainNav">
                <a onclick="showSection('home')">In√≠cio</a>
                <a onclick="scrollToComo()">Como Funciona</a>
                <a onclick="showSection('casos')">Casos</a>
                <a onclick="showSection('ranking')">Ranking</a>
                <button class="btn-primary" onclick="openLoginModal()">LOGIN</button>
            </nav>
            <nav id="userNav" style="display: none;">
                <a onclick="showSection('home')">In√≠cio</a>
                <a onclick="showSection('casos')">Casos</a>
                <a onclick="showSection('ranking')">Ranking</a>
                <a onclick="showSection('area')">MINHA √ÅREA</a>
                <button class="btn-secondary" onclick="logout()">SAIR</button>
            </nav>
        </div>
    </header>

    <!-- ==================== SE√á√ÉO HOME ==================== -->
    <div id="home-section" class="section active">
        <div class="hero">
            <div class="container">
                <h1>Resolva Mist√©rios Reais</h1>
                <p>Casos de assassinato baseados em hist√≥rias reais. Voc√™ tem o que √© preciso?</p>
                <button class="btn-primary" onclick="showSection('casos')">VER CASOS</button>
            </div>
        </div>

        <div class="container">
            <div class="cards">
                <div class="card">
                    <div class="card-icon">üîç</div>
                    <h3>Investigue</h3>
                    <p>Analise pistas, interrogue suspeitos e descubra a verdade por tr√°s de crimes reais.</p>
                </div>
                <div class="card">
                    <div class="card-icon">üß©</div>
                    <h3>Resolva</h3>
                    <p>Use sua l√≥gica e dedu√ß√£o para conectar as evid√™ncias e identificar o culpado.</p>
                </div>
                <div class="card">
                    <div class="card-icon">üèÜ</div>
                    <h3>Compita</h3>
                    <p>Compare sua pontua√ß√£o com outros detetives no ranking global.</p>
                </div>
            </div>
        </div>

        <div id="como-funciona">
            <div class="container">
                <h2 style="text-align: center; color: #dc3545; font-size: 38px; margin-bottom: 20px;">Como Funciona</h2>
                <div class="steps">
                    <div class="step">
                        <div class="step-number">1</div>
                        <h3>Escolha um Caso</h3>
                        <p>Selecione entre diversos casos de mist√©rio baseados em hist√≥rias reais.</p>
                    </div>
                    <div class="step">
                        <div class="step-number">2</div>
                        <h3>Analise as Evid√™ncias</h3>
                        <p>Baixe os documentos, fotos e relat√≥rios. Examine cada detalhe com aten√ß√£o.</p>
                    </div>
                    <div class="step">
                        <div class="step-number">3</div>
                        <h3>Resolva o Mist√©rio</h3>
                        <p>Identifique o culpado, o m√©todo e o motivo. Envie sua solu√ß√£o e ganhe pontos!</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ==================== SE√á√ÉO CASOS ==================== -->
    <div id="casos-section" class="section">
        <div class="container">
            <div class="area-header">
                <h1>üìÅ CASOS DISPON√çVEIS</h1>
                <p style="color: #999; font-size: 18px;">Escolha um caso e teste suas habilidades de detetive</p>
            </div>
            <div class="cards" id="casosContainer"></div>
        </div>
    </div>

    <!-- ==================== SE√á√ÉO RANKING ==================== -->
    <div id="ranking-section" class="section">
        <div class="container">
            <div class="area-header">
                <h1>üèÜ RANKING GLOBAL</h1>
                <p style="color: #999; font-size: 18px;">Os melhores detetives do mundo</p>
            </div>

            <div class="podio" id="podio"></div>
            <div class="ranking-list" id="rankingList"></div>
        </div>
    </div>

    <!-- ==================== √ÅREA DO DETETIVE ==================== -->
    <div id="area-section" class="section">
        <div class="container">
            <div class="area-header">
                <h1>üïµÔ∏è √ÅREA DO DETETIVE</h1>
                <p style="color: #999; font-size: 18px;" id="welcomeText">Bem-vindo(a), Detetive!</p>
            </div>

            <div class="area-menu">
                <button class="area-menu-btn active" onclick="showAreaContent('resumo')">üìä Resumo</button>
                <button class="area-menu-btn" onclick="showAreaContent('casos')">üìÅ Meus Casos</button>
                <button class="area-menu-btn" onclick="showAreaContent('promocoes')">üéñÔ∏è Promo√ß√µes</button>
                <button class="area-menu-btn" onclick="showAreaContent('conquistas')">üèÖ Conquistas</button>
                <button class="area-menu-btn" onclick="showAreaContent('pontuacao')">‚≠ê Pontua√ß√£o</button>
                <button class="area-menu-btn" onclick="showAreaContent('perfil')">üë§ Perfil</button>
            </div>

            <!-- Resumo -->
            <div id="area-resumo" class="area-content active">
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon">‚≠ê</div>
                        <div class="stat-value" id="totalPontos">0</div>
                        <div class="stat-label">PONTOS TOTAIS</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">üìÅ</div>
                        <div class="stat-value" id="casosResolvidos">0</div>
                        <div class="stat-label">CASOS RESOLVIDOS</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">üèÜ</div>
                        <div class="stat-value" id="posicaoRanking">-</div>
                        <div class="stat-label">POSI√á√ÉO NO RANKING</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">üéñÔ∏è</div>
                        <div class="stat-value" id="patenteAtual">J√∫nior</div>
                        <div class="stat-label">PATENTE ATUAL</div>
                    </div>
                </div>

                <div style="text-align: center; margin-top: 40px;">
                    <button class="btn-primary" onclick="showSection('casos')" style="font-size: 18px; padding: 15px 40px;">üîç INVESTIGAR CASOS</button>
                </div>
            </div>

            <!-- Meus Casos -->
            <div id="area-casos" class="area-content">
                <div id="meusCasosContainer">
                    <p style="text-align: center; color: #999; padding: 40px;">Voc√™ ainda n√£o possui casos. Compre casos na se√ß√£o de Casos Dispon√≠veis.</p>
                </div>
            </div>

            <!-- Promo√ß√µes -->
            <div id="area-promocoes" class="area-content">
                <div class="cards" style="max-width: 800px; margin: 0 auto;">
                    <div class="card">
                        <div class="card-icon">üéñÔ∏è</div>
                        <h3>DETETIVE J√öNIOR</h3>
                        <p>0 - 999 pontos<br>Patente inicial. Continue resolvendo casos!</p>
                    </div>
                    <div class="card">
                        <div class="card-icon">üéñÔ∏è</div>
                        <h3>DETETIVE PLENO</h3>
                        <p>1.000 - 4.999 pontos<br>Voc√™ est√° progredindo bem!</p>
                    </div>
                    <div class="card">
                        <div class="card-icon">üéñÔ∏è</div>
                        <h3>DETETIVE S√äNIOR</h3>
                        <p>5.000 - 9.999 pontos<br>Suas habilidades s√£o not√°veis!</p>
                    </div>
                    <div class="card">
                        <div class="card-icon">üèÖ</div>
                        <h3>INSPETOR</h3>
                        <p>10.000 - 19.999 pontos<br>Voc√™ √© um investigador experiente!</p>
                    </div>
                    <div class="card">
                        <div class="card-icon">üèÖ</div>
                        <h3>DELEGADO</h3>
                        <p>20.000 - 49.999 pontos<br>Poucos chegam at√© aqui!</p>
                    </div>
                    <div class="card">
                        <div class="card-icon">üëë</div>
                        <h3>LENDA SHERLOCK HOLMES</h3>
                        <p>50.000+ pontos<br>O maior detetive de todos os tempos!</p>
                    </div>
                </div>
            </div>

            <!-- Conquistas -->
            <div id="area-conquistas" class="area-content">
                <div class="cards" style="max-width: 1000px; margin: 0 auto;">
                    <div class="card">
                        <div class="card-icon">üèÜ</div>
                        <h3>PRIMEIRO CASO</h3>
                        <p>Resolva seu primeiro caso</p>
                    </div>
                    <div class="card">
                        <div class="card-icon">üî•</div>
                        <h3>EM CHAMAS</h3>
                        <p>Resolva 3 casos seguidos</p>
                    </div>
                    <div class="card">
                        <div class="card-icon">üíØ</div>
                        <h3>PERFECCIONISTA</h3>
                        <p>Acerte todas as respostas de um caso</p>
                    </div>
                    <div class="card">
                        <div class="card-icon">‚ö°</div>
                        <h3>REL√ÇMPAGO</h3>
                        <p>Resolva um caso em menos de 2 horas</p>
                    </div>
                    <div class="card">
                        <div class="card-icon">üéØ</div>
                        <h3>MESTRE DA DEDU√á√ÉO</h3>
                        <p>Resolva 10 casos</p>
                    </div>
                    <div class="card">
                        <div class="card-icon">üëë</div>
                        <h3>LENDA</h3>
                        <p>Atinja o topo do ranking</p>
                    </div>
                </div>
            </div>

            <!-- Pontua√ß√£o -->
            <div id="area-pontuacao" class="area-content">
                <div style="background: #1a1a1a; border-radius: 15px; padding: 30px; border: 2px solid rgba(220, 53, 69, 0.3);">
                    <h2 style="color: #dc3545; margin-bottom: 30px; text-align: center;">üìä SISTEMA DE PONTUA√á√ÉO</h2>
                    
                    <div style="margin-bottom: 40px;">
                        <h3 style="color: #dc3545; margin-bottom: 15px;">üéØ Como Ganhar Pontos</h3>
                        <div style="color: #999; line-height: 2;">
                            ‚Ä¢ Resolver PASTA 1: <strong style="color: #ffc107;">750 pontos</strong><br>
                            ‚Ä¢ Resolver PASTA 2: <strong style="color: #ffc107;">1.300 pontos</strong><br>
                            ‚Ä¢ Resolver PASTA 3: <strong style="color: #ffc107;">2.200 pontos</strong><br>
                            ‚Ä¢ Caso completo: <strong style="color: #ffc107;">4.250 pontos</strong>
                        </div>
                    </div>

                    <div style="margin-bottom: 40px;">
                        <h3 style="color: #dc3545; margin-bottom: 15px;">üèÖ B√¥nus Extras</h3>
                        <div style="color: #999; line-height: 2;">
                            ‚Ä¢ Resolver caso sem erros: <strong style="color: #ffc107;">+500 pontos</strong><br>
                            ‚Ä¢ Resolver em menos de 3 horas: <strong style="color: #ffc107;">+300 pontos</strong><br>
                            ‚Ä¢ Primeira vez no p√≥dio: <strong style="color: #ffc107;">+1.000 pontos</strong>
                        </div>
                    </div>

                    <div>
                        <h3 style="color: #dc3545; margin-bottom: 15px;">üìà Progresso Atual</h3>
                        <div style="background: rgba(255,255,255,0.05); padding: 20px; border-radius: 10px;">
                            <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                                <span style="color: #999;">Pontos Totais:</span>
                                <span style="color: #ffc107; font-weight: bold;" id="pontosTotais2">0</span>
                            </div>
                            <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                                <span style="color: #999;">Pr√≥xima Patente:</span>
                                <span style="color: #fff;" id="proximaPatente">Detetive Pleno (1.000 pts)</span>
                            </div>
                            <div style="display: flex; justify-content: space-between;">
                                <span style="color: #999;">Faltam:</span>
                                <span style="color: #dc3545; font-weight: bold;" id="pontosFaltando">1.000 pontos</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Perfil -->
            <div id="area-perfil" class="area-content">
                <div class="perfil-card">
                    <h2 style="color: #dc3545; margin-bottom: 30px; text-align: center;">üë§ MEU PERFIL</h2>
                    
                    <div class="form-group">
                        <label>Nome Completo</label>
                        <input type="text" id="perfilNome" placeholder="Seu nome">
                    </div>
                    
                    <div class="form-group">
                        <label>E-mail</label>
                        <input type="email" id="perfilEmail" placeholder="seu@email.com" disabled style="opacity: 0.6;">
                    </div>
                    
                    <div class="form-group">
                        <label>Nova Senha (deixe em branco para n√£o alterar)</label>
                        <input type="password" id="perfilNovaSenha" placeholder="Nova senha">
                    </div>
                    
                    <div class="form-group">
                        <label>Confirmar Nova Senha</label>
                        <input type="password" id="perfilConfirmarSenha" placeholder="Confirme a senha">
                    </div>
                    
                    <div id="perfilMessage" class="message"></div>
                    
                    <button class="btn-primary" style="width: 100%;" onclick="atualizarPerfil()">SALVAR ALTERA√á√ïES</button>
                </div>
            </div>
        </div>
    </div>

    <!-- ==================== SE√á√ÉO AJUDA ==================== -->
    <div id="ajuda-section" class="section">
        <div class="container">
            <div class="area-header">
                <h1>‚ùì PERGUNTAS FREQUENTES</h1>
            </div>

            <div style="max-width: 900px; margin: 0 auto;">
                <div class="faq-item">
                    <div class="faq-question">Como funciona o jogo?</div>
                    <div class="faq-answer">Voc√™ recebe um caso de mist√©rio com documentos reais, fotos e evid√™ncias. Sua miss√£o √© analisar tudo e identificar o culpado, o m√©todo e o motivo do crime.</div>
                </div>

                <div class="faq-item">
                    <div class="faq-question">Posso jogar sozinho?</div>
                    <div class="faq-answer">Sim! Mas o jogo fica ainda mais divertido em grupo (2-6 jogadores). Voc√™ pode jogar com amigos, fam√≠lia ou colegas.</div>
                </div>

                <div class="faq-item">
                    <div class="faq-question">Qual a dura√ß√£o de um caso?</div>
                    <div class="faq-answer">Depende da dificuldade. Casos f√°ceis levam cerca de 2 horas, m√©dios 3 horas e dif√≠ceis 4 horas ou mais.</div>
                </div>

                <div class="faq-item">
                    <div class="faq-question">Como funciona o ranking?</div>
                    <div class="faq-answer">Cada caso resolvido d√° pontos. Quanto mais casos voc√™ resolve e melhor seu desempenho, mais pontos ganha e sobe no ranking global.</div>
                </div>

                <div class="faq-item">
                    <div class="faq-question">Posso cancelar ou trocar um caso?</div>
                    <div class="faq-answer">Ap√≥s a compra, os casos n√£o podem ser trocados ou devolvidos, pois voc√™ recebe acesso imediato ao conte√∫do digital.</div>
                </div>

                <div class="faq-item">
                    <div class="faq-question">Os casos s√£o baseados em fatos reais?</div>
                    <div class="faq-answer">Sim! Todos os casos s√£o inspirados em crimes reais, mas adaptados e ficcionalizados para o jogo.</div>
                </div>
            </div>
        </div>
    </div>

    <!-- ==================== MODAL LOGIN ==================== -->
    <div id="loginModal" class="modal">
        <div class="modal-content">
            <button class="modal-close" onclick="closeLoginModal()">&times;</button>
            <h2 class="modal-title">üîç FATTO CRIMINAL</h2>
            <p class="modal-subtitle">Resolva Casos Reais de Mist√©rio</p>

            <div class="tabs">
                <button class="tab active" onclick="showLoginTab()">LOGIN</button>
                <button class="tab" onclick="showCadastroTab()">CADASTRAR</button>
            </div>

            <div id="message" class="message"></div>

            <!-- Form Login -->
            <form id="loginForm">
                <div class="form-group">
                    <label>E-mail</label>
                    <input type="email" id="loginEmail" placeholder="seu@email.com" required>
                </div>
                <div class="form-group">
                    <label>Senha</label>
                    <input type="password" id="loginPassword" placeholder="Sua senha" required>
                </div>
                <button type="submit" class="btn-primary" style="width: 100%;">ENTRAR</button>
            </form>

            <!-- Form Cadastro -->
            <form id="cadastroForm" style="display: none;">
                <div class="form-group">
                    <label>Nome Completo</label>
                    <input type="text" id="cadastroNome" placeholder="Seu nome completo" required>
                </div>
                <div class="form-group">
                    <label>E-mail</label>
                    <input type="email" id="cadastroEmail" placeholder="seu@email.com" required>
                </div>
                <div class="form-group">
                    <label>Telefone</label>
                    <input type="tel" id="cadastroTelefone" placeholder="(00) 00000-0000">
                </div>
                <div class="form-group">
                    <label>Senha</label>
                    <input type="password" id="cadastroPassword" placeholder="M√≠nimo 6 caracteres" required>
                </div>
                <div class="form-group">
                    <label>Confirmar Senha</label>
                    <input type="password" id="cadastroPasswordConfirm" placeholder="Digite novamente" required>
                </div>
                <button type="submit" class="btn-primary" style="width: 100%;">CRIAR CONTA</button>
            </form>
        </div>
    </div>

    <!-- ==================== BOT√ÉO FLUTUANTE ==================== -->
    <button class="delegado-btn" onclick="window.open('https://wa.me/5517997045868', '_blank')">
        <span>üïµÔ∏è</span>
        <span>Fale com o Delegado Virtual</span>
    </button>

    <!-- ==================== RODAP√â ==================== -->
    <footer>
        <div class="footer-content">
            <div class="footer-section">
                <h3>FATTO CRIMINAL</h3>
                <p>Jogos de Mist√©rio e Investiga√ß√£o</p>
                <p>Catanduva, SP - CEP 15810-215</p>
                <p>fattocriminal@gmail.com</p>
            </div>
            <div class="footer-section">
                <h3>NAVEGA√á√ÉO</h3>
                <a href="#" onclick="showSection('home')">In√≠cio</a>
                <a href="#" onclick="showSection('casos')">Casos</a>
                <a href="#" onclick="showSection('ranking')">Ranking</a>
                <a href="#" onclick="showSection('ajuda')">Ajuda</a>
            </div>
            <div class="footer-section">
                <h3>SUPORTE</h3>
                <a href="#" onclick="showSection('ajuda')">Perguntas Frequentes</a>
                <a href="#" onclick="window.open('https://wa.me/5517997045868', '_blank')">Fale com o Delegado Virtual</a>
                <a href="#">Pol√≠tica de Privacidade</a>
                <a href="#">Termos de Uso</a>
            </div>
            <div class="footer-section">
                <h3>REDES SOCIAIS</h3>
                <a href="#">Instagram</a>
                <a href="#">TikTok</a>
                <a href="#">YouTube</a>
                <a href="#">Facebook</a>
            </div>
        </div>
        <div class="footer-bottom">
            <p>&copy; 2025 Fatto Criminal. Todos os direitos reservados.</p>
        </div>
    </footer>

    <!-- ==================== FIREBASE & SCRIPTS ==================== -->
    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
        import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, onAuthStateChanged, signOut, updateProfile, updatePassword } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js';
        import { getFirestore, doc, setDoc, getDoc, updateDoc, serverTimestamp, collection, query, orderBy, getDocs, limit } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js';

        const firebaseConfig = {
            apiKey: "AIzaSyBUavAk-f5nqe3x_xzI_ZLoU9oqoEzMCV4",
            authDomain: "fatto-criminal-7addf.firebaseapp.com",
            databaseURL: "https://fatto-criminal-7addf-default-rtdb.firebaseio.com",
            projectId: "fatto-criminal-7addf",
            storageBucket: "fatto-criminal-7addf.firebasestorage.app",
            messagingSenderId: "90391050719",
            appId: "1:90391050719:web:3712862c39cacb65e52c6a",
            measurementId: "G-8VJD43K4R6"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);

        let currentUser = null;

        // Dados dos casos
        const casos = [
            {
                id: 'FC00001',
                titulo: 'O Expresso Noturno 247',
                descricao: 'Uma morte no trem. Um mist√©rio a ser resolvido.',
                imagem: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)',
                dificuldade: 'M√©dio',
                duracao: '3h',
                jogadores: '2-6',
                idade: '16 anos',
                preco: 59.90,
                precoFisico: 89.90
            },
            {
                id: 'FC00002',
                titulo: 'A √öltima Exposi√ß√£o',
                descricao: 'Morte na galeria de arte',
                imagem: 'linear-gradient(135deg, #f093fb 0%, #f5576c 100%)',
                dificuldade: 'Dif√≠cil',
                duracao: '4h',
                jogadores: '2-4',
                idade: '18 anos',
                preco: 69.90,
                precoFisico: 99.90
            },
            {
                id: 'FC00003',
                titulo: 'Sil√™ncio no Farol',
                descricao: 'Faroleiro desaparecido',
                imagem: 'linear-gradient(135deg, #4facfe 0%, #00f2fe 100%)',
                dificuldade: 'Dif√≠cil',
                duracao: '4h',
                jogadores: '2-6',
                idade: '18 anos',
                preco: 79.90,
                precoFisico: 109.90
            },
            {
                id: 'FC00004',
                titulo: 'Caos no Cassino Royal',
                descricao: 'Jogador assassinado',
                imagem: 'linear-gradient(135deg, #fa709a 0%, #fee140 100%)',
                dificuldade: 'M√©dio',
                duracao: '3h',
                jogadores: '2-4',
                idade: '16 anos',
                preco: 59.90,
                precoFisico: 89.90
            },
            {
                id: 'FC00005',
                titulo: 'Overdose no Hospital Central',
                descricao: 'M√©dico-Chefe assassinado',
                imagem: 'linear-gradient(135deg, #a8edea 0%, #fed6e3 100%)',
                dificuldade: 'Dif√≠cil',
                duracao: '4h',
                jogadores: '2-6',
                idade: '18 anos',
                preco: 69.90,
                precoFisico: 99.90
            },
            {
                id: 'FC00006',
                titulo: 'Trai√ß√£o no Palco',
                descricao: 'Ator principal morto',
                imagem: 'linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%)',
                dificuldade: 'F√°cil',
                duracao: '2h',
                jogadores: '2-4',
                idade: '14 anos',
                preco: 49.90,
                precoFisico: 79.90
            }
        ];

        // Fun√ß√µes globais
        window.showSection = function(sectionName) {
            document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
            document.getElementById(`${sectionName}-section`).classList.add('active');
            window.scrollTo(0, 0);
        }

        window.scrollToComo = function() {
            document.getElementById('como-funciona').scrollIntoView({ behavior: 'smooth' });
        }

        window.openLoginModal = function() {
            document.getElementById('loginModal').classList.add('active');
        }

        window.closeLoginModal = function() {
            document.getElementById('loginModal').classList.remove('active');
            hideMessage();
        }

        window.showLoginTab = function() {
            document.querySelectorAll('.tab')[0].classList.add('active');
            document.querySelectorAll('.tab')[1].classList.remove('active');
            document.getElementById('loginForm').style.display = 'block';
            document.getElementById('cadastroForm').style.display = 'none';
            hideMessage();
        }

        window.showCadastroTab = function() {
            document.querySelectorAll('.tab')[1].classList.add('active');
            document.querySelectorAll('.tab')[0].classList.remove('active');
            document.getElementById('loginForm').style.display = 'none';
            document.getElementById('cadastroForm').style.display = 'block';
            hideMessage();
        }

        window.showAreaContent = function(contentName) {
            document.querySelectorAll('.area-menu-btn').forEach(btn => btn.classList.remove('active'));
            document.querySelectorAll('.area-content').forEach(content => content.classList.remove('active'));
            
            event.target.classList.add('active');
            document.getElementById(`area-${contentName}`).classList.add('active');
        }

        window.logout = function() {
            signOut(auth);
        }

        function showMessage(text, type) {
            const message = document.getElementById('message');
            message.textContent = text;
            message.className = `message ${type}`;
            message.style.display = 'block';
        }

        function hideMessage() {
            const message = document.getElementById('message');
            message.style.display = 'none';
        }

        // Renderizar casos
        function renderCasos() {
            const container = document.getElementById('casosContainer');
            container.innerHTML = casos.map(caso => `
                <div class="caso-item">
                    <div class="caso-image" style="background: ${caso.imagem};">üîç</div>
                    <div class="caso-content">
                        <div class="caso-title">${caso.titulo}</div>
                        <div class="caso-desc">${caso.descricao}</div>
                        <div class="caso-info">
                            <div class="caso-info-item">‚ö° ${caso.dificuldade}</div>
                            <div class="caso-info-item">‚è±Ô∏è ${caso.duracao}</div>
                            <div class="caso-info-item">üë• ${caso.jogadores}</div>
                            <div class="caso-info-item">üîû ${caso.idade}</div>
                        </div>
                        <button class="btn-primary" style="width: 100%;" onclick="verDetalheCaso('${caso.id}')">VER CASO</button>
                    </div>
                </div>
            `).join('');
        }

        // Ver detalhes do caso - CORRIGIDO: Modal menor e sistema de compra funcional
        window.verDetalheCaso = function(casoId) {
            if (!currentUser) {
                alert('Fa√ßa login para comprar casos!');
                openLoginModal();
                return;
            }

            const caso = casos.find(c => c.id === casoId);
            if (!caso) return;

            const html = `
                <div style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.95); z-index: 3000; display: flex; justify-content: center; align-items: center; padding: 20px; overflow-y: auto;" id="casoModal" onclick="if(event.target.id === 'casoModal') this.remove()">
                    <div style="background: #1a1a1a; border: 2px solid #dc3545; border-radius: 20px; padding: 25px; max-width: 700px; width: 100%; max-height: 80vh; overflow-y: auto; position: relative;">
                        <button onclick="document.getElementById('casoModal').remove()" style="position: absolute; top: 15px; right: 15px; background: none; border: none; color: #999; font-size: 24px; cursor: pointer; z-index: 1;">&times;</button>
                        
                        <div style="text-align: center; margin-bottom: 25px;">
                            <div style="background: ${caso.imagem}; height: 150px; border-radius: 15px; margin-bottom: 15px; display: flex; align-items: center; justify-content: center; font-size: 72px;">üîç</div>
                            <h2 style="color: #dc3545; font-size: 26px; margin-bottom: 8px;">${caso.titulo}</h2>
                            <p style="color: #999; font-size: 15px;">${caso.descricao}</p>
                        </div>

                        <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; margin-bottom: 25px;">
                            <div style="background: rgba(255,255,255,0.05); padding: 12px; border-radius: 10px; text-align: center;">
                                <div style="color: #ffc107; font-size: 20px; margin-bottom: 5px;">‚ö°</div>
                                <div style="color: #999; font-size: 11px;">DIFICULDADE</div>
                                <div style="color: #fff; font-weight: bold; font-size: 14px;">${caso.dificuldade}</div>
                            </div>
                            <div style="background: rgba(255,255,255,0.05); padding: 12px; border-radius: 10px; text-align: center;">
                                <div style="color: #ffc107; font-size: 20px; margin-bottom: 5px;">‚è±Ô∏è</div>
                                <div style="color: #999; font-size: 11px;">DURA√á√ÉO</div>
                                <div style="color: #fff; font-weight: bold; font-size: 14px;">${caso.duracao}</div>
                            </div>
                            <div style="background: rgba(255,255,255,0.05); padding: 12px; border-radius: 10px; text-align: center;">
                                <div style="color: #ffc107; font-size: 20px; margin-bottom: 5px;">üë•</div>
                                <div style="color: #999; font-size: 11px;">JOGADORES</div>
                                <div style="color: #fff; font-weight: bold; font-size: 14px;">${caso.jogadores}</div>
                            </div>
                            <div style="background: rgba(255,255,255,0.05); padding: 12px; border-radius: 10px; text-align: center;">
                                <div style="color: #ffc107; font-size: 20px; margin-bottom: 5px;">üîû</div>
                                <div style="color: #999; font-size: 11px;">CLASSIFICA√á√ÉO</div>
                                <div style="color: #fff; font-weight: bold; font-size: 14px;">${caso.idade}</div>
                            </div>
                        </div>

                        <div style="background: rgba(220, 53, 69, 0.1); border: 2px solid #dc3545; border-radius: 15px; padding: 20px; margin-bottom: 20px;">
                            <h3 style="color: #dc3545; margin-bottom: 15px; text-align: center; font-size: 18px;">ESCOLHA SUA VERS√ÉO</h3>
                            
                            <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px;">
                                <div style="background: rgba(255,255,255,0.05); border: 2px solid rgba(220,53,69,0.3); border-radius: 10px; padding: 15px; text-align: center;">
                                    <div style="font-size: 32px; margin-bottom: 8px;">üì±</div>
                                    <div style="font-weight: bold; margin-bottom: 8px; font-size: 14px;">DIGITAL</div>
                                    <div style="color: #999; font-size: 12px; margin-bottom: 12px;">Receba por email</div>
                                    <div style="color: #ffc107; font-size: 24px; font-weight: bold; margin-bottom: 12px;">R$ ${caso.preco.toFixed(2)}</div>
                                    <button class="btn-primary" style="width: 100%; padding: 10px; font-size: 14px;" onclick="event.stopPropagation(); comprarCaso('${caso.id}', 'digital', ${caso.preco})">COMPRAR</button>
                                </div>
                                
                                <div style="background: rgba(255,255,255,0.05); border: 2px solid rgba(220,53,69,0.3); border-radius: 10px; padding: 15px; text-align: center;">
                                    <div style="font-size: 32px; margin-bottom: 8px;">üì¶</div>
                                    <div style="font-weight: bold; margin-bottom: 8px; font-size: 14px;">F√çSICA</div>
                                    <div style="color: #999; font-size: 12px; margin-bottom: 12px;">Receba em casa</div>
                                    <div style="color: #ffc107; font-size: 24px; font-weight: bold; margin-bottom: 12px;">R$ ${caso.precoFisico.toFixed(2)}</div>
                                    <button class="btn-primary" style="width: 100%; padding: 10px; font-size: 14px;" onclick="event.stopPropagation(); comprarCaso('${caso.id}', 'fisica', ${caso.precoFisico})">COMPRAR</button>
                                </div>
                            </div>
                        </div>

                        <button class="btn-secondary" style="width: 100%; padding: 12px;" onclick="document.getElementById('casoModal').remove()">FECHAR</button>
                    </div>
                </div>
            `;

            document.body.insertAdjacentHTML('beforeend', html);
        }

        // Fun√ß√£o de compra - NOVA IMPLEMENTA√á√ÉO
        window.comprarCaso = async function(casoId, tipo, preco) {
            if (!currentUser) {
                alert('Voc√™ precisa estar logado!');
                return;
            }

            const caso = casos.find(c => c.id === casoId);
            
            // Modal de confirma√ß√£o de compra
            const confirmHtml = `
                <div style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.95); z-index: 3500; display: flex; justify-content: center; align-items: center; padding: 20px;" id="confirmModal">
                    <div style="background: #1a1a1a; border: 2px solid #dc3545; border-radius: 20px; padding: 30px; max-width: 500px; width: 100%; text-align: center;">
                        <div style="font-size: 64px; margin-bottom: 20px;">üéØ</div>
                        <h2 style="color: #dc3545; margin-bottom: 20px; font-size: 24px;">CONFIRMAR COMPRA</h2>
                        
                        <div style="background: rgba(255,255,255,0.05); padding: 20px; border-radius: 15px; margin-bottom: 20px; text-align: left;">
                            <div style="color: #fff; font-weight: bold; margin-bottom: 10px; font-size: 18px;">${caso.titulo}</div>
                            <div style="color: #999; margin-bottom: 15px;">${caso.descricao}</div>
                            <div style="display: flex; justify-content: space-between; padding-top: 15px; border-top: 1px solid rgba(220,53,69,0.3);">
                                <span style="color: #999;">Vers√£o ${tipo === 'digital' ? 'Digital üì±' : 'F√≠sica üì¶'}:</span>
                                <span style="color: #ffc107; font-weight: bold; font-size: 20px;">R$ ${preco.toFixed(2)}</span>
                            </div>
                        </div>

                        <div style="background: rgba(220, 53, 69, 0.1); border: 1px solid #dc3545; border-radius: 10px; padding: 15px; margin-bottom: 20px;">
                            <p style="color: #fff; font-size: 14px; line-height: 1.6;">
                                üí° <strong>AVISO IMPORTANTE:</strong><br>
                                Esta √© uma vers√£o de teste. A compra ser√° registrada em sua conta, mas nenhum pagamento real ser√° processado.
                            </p>
                        </div>

                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                            <button class="btn-secondary" style="width: 100%; padding: 12px;" onclick="document.getElementById('confirmModal').remove()">CANCELAR</button>
                            <button class="btn-primary" style="width: 100%; padding: 12px;" onclick="finalizarCompra('${casoId}', '${tipo}', ${preco})">CONFIRMAR</button>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.insertAdjacentHTML('beforeend', confirmHtml);
        }

        // Finalizar compra
        window.finalizarCompra = async function(casoId, tipo, preco) {
            try {
                // Fechar modais
                document.getElementById('confirmModal')?.remove();
                document.getElementById('casoModal')?.remove();

                // Mostrar loading
                const loadingHtml = `
                    <div style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.95); z-index: 4000; display: flex; justify-content: center; align-items: center;" id="loadingModal">
                        <div style="text-align: center;">
                            <div style="font-size: 72px; margin-bottom: 20px;">‚è≥</div>
                            <div style="color: #dc3545; font-size: 24px; font-weight: bold;">PROCESSANDO COMPRA...</div>
                        </div>
                    </div>
                `;
                document.body.insertAdjacentHTML('beforeend', loadingHtml);

                // Simular processamento (2 segundos)
                await new Promise(resolve => setTimeout(resolve, 2000));

                // Adicionar caso √† conta do usu√°rio no Firebase
                const userDocRef = doc(db, 'usuarios', currentUser.uid);
                const userDoc = await getDoc(userDocRef);
                
                let casosComprados = [];
                if (userDoc.exists()) {
                    casosComprados = userDoc.data().casosComprados || [];
                }

                // Verificar se j√° tem o caso
                if (!casosComprados.find(c => c.casoId === casoId)) {
                    casosComprados.push({
                        casoId: casoId,
                        tipo: tipo,
                        preco: preco,
                        dataCompra: new Date().toISOString(),
                        status: 'disponivel'
                    });

                    await updateDoc(userDocRef, {
                        casosComprados: casosComprados,
                        ultimaCompra: serverTimestamp()
                    });
                }

                // Remover loading
                document.getElementById('loadingModal')?.remove();

                // Mostrar sucesso
                const caso = casos.find(c => c.id === casoId);
                const sucessoHtml = `
                    <div style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.95); z-index: 4000; display: flex; justify-content: center; align-items: center; padding: 20px;" id="sucessoModal">
                        <div style="background: #1a1a1a; border: 2px solid #28a745; border-radius: 20px; padding: 40px; max-width: 500px; width: 100%; text-align: center;">
                            <div style="font-size: 72px; margin-bottom: 20px;">‚úÖ</div>
                            <h2 style="color: #28a745; margin-bottom: 20px; font-size: 28px;">COMPRA REALIZADA!</h2>
                            
                            <div style="background: rgba(40, 167, 69, 0.1); border: 1px solid #28a745; border-radius: 15px; padding: 20px; margin-bottom: 25px;">
                                <div style="color: #fff; font-weight: bold; margin-bottom: 10px; font-size: 18px;">${caso.titulo}</div>
                                <div style="color: #999; font-size: 14px;">Vers√£o ${tipo === 'digital' ? 'Digital' : 'F√≠sica'}</div>
                                <div style="color: #28a745; font-weight: bold; font-size: 24px; margin-top: 10px;">R$ ${preco.toFixed(2)}</div>
                            </div>

                            <div style="background: rgba(255,255,255,0.05); border-radius: 10px; padding: 15px; margin-bottom: 25px; text-align: left;">
                                <p style="color: #fff; font-size: 14px; line-height: 1.6;">
                                    ${tipo === 'digital' 
                                        ? 'üìß Os arquivos do caso ser√£o enviados para seu e-mail em at√© 24 horas.<br><br>üìÅ O caso j√° est√° dispon√≠vel em "Meus Casos"!' 
                                        : 'üì¶ Seu caso ser√° enviado pelos Correios em at√© 7 dias √∫teis.<br><br>üìÅ Os arquivos digitais j√° est√£o dispon√≠veis em "Meus Casos"!'}
                                </p>
                            </div>

                            <button class="btn-primary" style="width: 100%; padding: 15px; font-size: 16px;" onclick="document.getElementById('sucessoModal').remove(); showSection('area'); showAreaContent('casos');">VER MEUS CASOS</button>
                        </div>
                    </div>
                `;
                document.body.insertAdjacentHTML('beforeend', sucessoHtml);

                // Atualizar dados do usu√°rio
                await carregarDadosUsuario();

            } catch (error) {
                console.error('Erro na compra:', error);
                document.getElementById('loadingModal')?.remove();
                alert('Erro ao processar compra. Tente novamente.');
            }
        }

        // Carregar ranking
        async function carregarRanking() {
            try {
                const q = query(collection(db, 'usuarios'), orderBy('pontos', 'desc'), limit(20));
                const querySnapshot = await getDocs(q);
                
                const usuarios = [];
                querySnapshot.forEach((doc) => {
                    usuarios.push({ id: doc.id, ...doc.data() });
                });

                // P√≥dio (Top 3)
                const podio = document.getElementById('podio');
                if (usuarios.length >= 3) {
                    podio.innerHTML = `
                        <div class="podio-item segundo">
                            <div class="podio-medal">ü•à</div>
                            <div style="font-weight: bold; color: #fff; margin-bottom: 5px;">${usuarios[1]?.nome || 'An√¥nimo'}</div>
                            <div style="color: #ffc107; font-size: 24px; font-weight: bold;">${usuarios[1]?.pontos || 0} pts</div>
                        </div>
                        <div class="podio-item primeiro">
                            <div class="podio-medal">ü•á</div>
                            <div style="font-weight: bold; color: #fff; margin-bottom: 5px;">${usuarios[0]?.nome || 'An√¥nimo'}</div>
                            <div style="color: #ffc107; font-size: 28px; font-weight: bold;">${usuarios[0]?.pontos || 0} pts</div>
                        </div>
                        <div class="podio-item terceiro">
                            <div class="podio-medal">ü•â</div>
                            <div style="font-weight: bold; color: #fff; margin-bottom: 5px;">${usuarios[2]?.nome || 'An√¥nimo'}</div>
                            <div style="color: #ffc107; font-size: 24px; font-weight: bold;">${usuarios[2]?.pontos || 0} pts</div>
                        </div>
                    `;
                }

                // Lista completa
                const rankingList = document.getElementById('rankingList');
                rankingList.innerHTML = '<h3 style="color: #dc3545; margin-bottom: 20px; text-align: center;">üìä RANKING COMPLETO</h3>' +
                    usuarios.slice(3).map((user, index) => {
                        const isCurrentUser = currentUser && user.id === currentUser.uid;
                        return `
                            <div class="ranking-item ${isCurrentUser ? 'destaque' : ''}">
                                <div>
                                    <span style="color: #ffc107; font-weight: bold; margin-right: 15px;">#${index + 4}</span>
                                    <span style="color: #fff; font-weight: ${isCurrentUser ? 'bold' : 'normal'};">${user.nome || 'An√¥nimo'}</span>
                                    ${isCurrentUser ? '<span style="color: #dc3545; margin-left: 10px;">(VOC√ä)</span>' : ''}
                                </div>
                                <div style="color: #ffc107; font-weight: bold;">${user.pontos || 0} pts</div>
                            </div>
                        `;
                    }).join('');
            } catch (error) {
                console.error('Erro ao carregar ranking:', error);
            }
        }

        // Carregar dados do usu√°rio
        async function carregarDadosUsuario() {
            if (!currentUser) return;

            try {
                const userDocRef = doc(db, 'usuarios', currentUser.uid);
                const userDoc = await getDoc(userDocRef);

                if (userDoc.exists()) {
                    const userData = userDoc.data();
                    
                    // Atualizar estat√≠sticas
                    document.getElementById('totalPontos').textContent = userData.pontos || 0;
                    document.getElementById('casosResolvidos').textContent = userData.casosResolvidos || 0;
                    document.getElementById('pontosTotais2').textContent = userData.pontos || 0;
                    
                    // Calcular patente
                    const pontos = userData.pontos || 0;
                    let patente = 'Detetive J√∫nior';
                    if (pontos >= 50000) patente = 'Lenda Sherlock';
                    else if (pontos >= 20000) patente = 'Delegado';
                    else if (pontos >= 10000) patente = 'Inspetor';
                    else if (pontos >= 5000) patente = 'Detetive S√™nior';
                    else if (pontos >= 1000) patente = 'Detetive Pleno';
                    
                    document.getElementById('patenteAtual').textContent = patente;

                    // Calcular pr√≥xima patente
                    let proximaPatente = 'Detetive Pleno (1.000 pts)';
                    let pontosFaltando = 1000 - pontos;
                    
                    if (pontos >= 20000) {
                        proximaPatente = 'Lenda Sherlock (50.000 pts)';
                        pontosFaltando = 50000 - pontos;
                    } else if (pontos >= 10000) {
                        proximaPatente = 'Delegado (20.000 pts)';
                        pontosFaltando = 20000 - pontos;
                    } else if (pontos >= 5000) {
                        proximaPatente = 'Inspetor (10.000 pts)';
                        pontosFaltando = 10000 - pontos;
                    } else if (pontos >= 1000) {
                        proximaPatente = 'Detetive S√™nior (5.000 pts)';
                        pontosFaltando = 5000 - pontos;
                    }

                    if (pontos >= 50000) {
                        document.getElementById('proximaPatente').textContent = 'M√°xima alcan√ßada!';
                        document.getElementById('pontosFaltando').textContent = 'üéâ Parab√©ns!';
                    } else {
                        document.getElementById('proximaPatente').textContent = proximaPatente;
                        document.getElementById('pontosFaltando').textContent = pontosFaltando + ' pontos';
                    }

                    // Buscar posi√ß√£o no ranking
                    const q = query(collection(db, 'usuarios'), orderBy('pontos', 'desc'));
                    const querySnapshot = await getDocs(q);
                    let posicao = 0;
                    querySnapshot.forEach((doc, index) => {
                        if (doc.id === currentUser.uid) {
                            posicao = index + 1;
                        }
                    });
                    document.getElementById('posicaoRanking').textContent = posicao > 0 ? `#${posicao}` : '-';

                    // Mostrar casos comprados
                    const casosComprados = userData.casosComprados || [];
                    const meusCasosContainer = document.getElementById('meusCasosContainer');
                    
                    if (casosComprados.length === 0) {
                        meusCasosContainer.innerHTML = '<p style="text-align: center; color: #999; padding: 40px;">Voc√™ ainda n√£o possui casos. Compre casos na se√ß√£o de Casos Dispon√≠veis.</p>';
                    } else {
                        meusCasosContainer.innerHTML = '<div class="cards">' + 
                            casosComprados.map(compra => {
                                const caso = casos.find(c => c.id === compra.casoId);
                                if (!caso) return '';
                                
                                return `
                                    <div class="caso-item">
                                        <div class="caso-image" style="background: ${caso.imagem};">üîç</div>
                                        <div class="caso-content">
                                            <div class="caso-title">${caso.titulo}</div>
                                            <div class="caso-desc">${caso.descricao}</div>
                                            <div style="background: rgba(40, 167, 69, 0.2); border: 1px solid #28a745; border-radius: 8px; padding: 10px; margin: 15px 0; text-align: center;">
                                                <div style="color: #28a745; font-weight: bold; font-size: 12px;">‚úÖ CASO ADQUIRIDO</div>
                                                <div style="color: #999; font-size: 11px; margin-top: 5px;">Vers√£o ${compra.tipo === 'digital' ? 'Digital üì±' : 'F√≠sica üì¶'}</div>
                                            </div>
                                            <button class="btn-primary" style="width: 100%;" onclick="alert('üéÆ Fun√ß√£o de jogo em desenvolvimento!\\n\\nEm breve voc√™ podr√° resolver os casos diretamente pelo site!')">JOGAR AGORA</button>
                                        </div>
                                    </div>
                                `;
                            }).join('') + '</div>';
                    }

                    // Atualizar perfil
                    document.getElementById('perfilNome').value = userData.nome || '';
                    document.getElementById('perfilEmail').value = currentUser.email || '';
                    document.getElementById('welcomeText').textContent = `Bem-vindo(a), ${userData.nome || 'Detetive'}!`;
                }
            } catch (error) {
                console.error('Erro ao carregar dados:', error);
            }
        }

        // Atualizar perfil
        window.atualizarPerfil = async function() {
            const nome = document.getElementById('perfilNome').value.trim();
            const novaSenha = document.getElementById('perfilNovaSenha').value;
            const confirmarSenha = document.getElementById('perfilConfirmarSenha').value;

            const messageEl = document.getElementById('perfilMessage');

            if (!nome) {
                messageEl.textContent = 'Por favor, preencha o nome!';
                messageEl.className = 'message error';
                messageEl.style.display = 'block';
                return;
            }

            if (novaSenha && novaSenha !== confirmarSenha) {
                messageEl.textContent = 'As senhas n√£o coincidem!';
                messageEl.className = 'message error';
                messageEl.style.display = 'block';
                return;
            }

            if (novaSenha && novaSenha.length < 6) {
                messageEl.textContent = 'A senha deve ter no m√≠nimo 6 caracteres!';
                messageEl.className = 'message error';
                messageEl.style.display = 'block';
                return;
            }

            try {
                // Atualizar nome
                await updateProfile(auth.currentUser, { displayName: nome });
                
                const userDocRef = doc(db, 'usuarios', currentUser.uid);
                await updateDoc(userDocRef, { nome: nome });

                // Atualizar senha se fornecida
                if (novaSenha) {
                    await updatePassword(auth.currentUser, novaSenha);
                }

                messageEl.textContent = 'Perfil atualizado com sucesso!';
                messageEl.className = 'message success';
                messageEl.style.display = 'block';

                // Limpar campos de senha
                document.getElementById('perfilNovaSenha').value = '';
                document.getElementById('perfilConfirmarSenha').value = '';

                await carregarDadosUsuario();

                setTimeout(() => {
                    messageEl.style.display = 'none';
                }, 3000);
            } catch (error) {
                console.error('Erro:', error);
                messageEl.textContent = 'Erro ao atualizar perfil!';
                messageEl.className = 'message error';
                messageEl.style.display = 'block';
            }
        }

        // Login
        document.getElementById('loginForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;

            try {
                await signInWithEmailAndPassword(auth, email, password);
                showMessage('Login realizado com sucesso!', 'success');
                setTimeout(() => {
                    closeLoginModal();
                    showSection('area');
                }, 1000);
            } catch (error) {
                showMessage('E-mail ou senha incorretos!', 'error');
            }
        });

        // Cadastro
        document.getElementById('cadastroForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const nome = document.getElementById('cadastroNome').value.trim();
            const email = document.getElementById('cadastroEmail').value.trim();
            const telefone = document.getElementById('cadastroTelefone').value.trim();
            const password = document.getElementById('cadastroPassword').value;
            const confirmPassword = document.getElementById('cadastroPasswordConfirm').value;

            if (!nome) {
                showMessage('Por favor, preencha seu nome!', 'error');
                return;
            }

            if (password !== confirmPassword) {
                showMessage('As senhas n√£o coincidem!', 'error');
                return;
            }

            if (password.length < 6) {
                showMessage('A senha deve ter no m√≠nimo 6 caracteres!', 'error');
                return;
            }

            try {
                const userCredential = await createUserWithEmailAndPassword(auth, email, password);
                await updateProfile(userCredential.user, { displayName: nome });

                await setDoc(doc(db, 'usuarios', userCredential.user.uid), {
                    nome: nome,
                    email: email,
                    telefone: telefone,
                    pontos: 0,
                    casosResolvidos: 0,
                    casosComprados: [],
                    dataCriacao: serverTimestamp()
                });

                showMessage('Conta criada com sucesso!', 'success');
                setTimeout(() => {
                    closeLoginModal();
                    showSection('area');
                }, 1000);
            } catch (error) {
                console.error('Erro:', error);
                if (error.code === 'auth/email-already-in-use') {
                    showMessage('Este e-mail j√° est√° cadastrado!', 'error');
                } else if (error.code === 'auth/invalid-email') {
                    showMessage('E-mail inv√°lido!', 'error');
                } else if (error.code === 'auth/weak-password') {
                    showMessage('Senha muito fraca!', 'error');
                } else {
                    showMessage('Erro ao criar conta. Tente novamente!', 'error');
                }
            }
        });

        // Observer de autentica√ß√£o
        onAuthStateChanged(auth, async (user) => {
            currentUser = user;
            
            if (user) {
                document.getElementById('mainNav').style.display = 'none';
                document.getElementById('userNav').style.display = 'flex';
                await carregarDadosUsuario();
            } else {
                document.getElementById('mainNav').style.display = 'flex';
                document.getElementById('userNav').style.display = 'none';
            }
        });

        // Inicializar
        renderCasos();
        carregarRanking();
    </script>
</body>
</html>
